  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no"
      />

      <!-- Bootstrap CSS -->
      <link
        rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous"
      />
      <title>Story Contributions</title>
    </head>

    <body>
      <%- include('navbar') %>
      <main style="margin: 1em;">
        <h3>Story Contributions</h3>
        <tr>
          <td>
          Story Title: <%= story.title %>
          <br>
          <div id="storyContents">
            <%= story.contents %>
          </div>
        </td>
      </tr>
      <ul>
        <form id="completeStory" action="/story/<%= story.id%>/status" method="post">
          <input type="submit" name="status" value="Complete Story" />
        </form>

        <% for (let idx in contributions) {%>
          <li>
            <div id="contributionList">
              <%= contributions[idx].contents %>
            </div>
            <div>
              <button class="addBtn" id="acceptContribution">Add</button>
            </div>
            <p class="numOfVotes"><%=contributions[idx].upvotes%> Votes</p>
            <form class="upVote" onclick="upVote('<%= idx%>')" action="/contributions/<%= contributions[idx].id%>/upvote" method="post">
              <input class="voteBtn" type="submit" name="storyId" value="Upvote" />
            </form>
          </li>
          <%}%>
        </ul>

        <form class="form-inline" action="/contributions/story/<%= story.id %>" method="POST">
          <div class="form-group mb-2">
            <label for="contribution">Enter a Contribution for the Story:</label>
            <input
            class="form-control"
            type="text"
            name="contribution"
            style="width: 300px; margin: 1em"
            />
            <button id="submit" type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>
      </main>
  <!-- Bootstrap JS -->
  <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>

  <!-- Add Contribution Script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const acceptContribution = document.getElementById('acceptContribution');
      const contributionList = document.getElementById('contributionList');
      let storyCreated = document.getElementById('storyCreated');

      acceptContribution.addEventListener('click', () => {
        const newContribution = `<%= story.contents %>` + ' ' + contributionList.innerText;
        console.log(newContribution);
        document.getElementById('storyContents').textContent = newContribution;
        document.getElementById('contribution').textContent = '';
      });

    });
  </script>
  <!-- Complete Story Button Script -->
  <script>
    document.getElementById('completeStory').addEventListener('click', () => {
      const contribution = document.getElementsByClassName('contribution');
      const submit = document.getElementById('submit');
      const completeStory = document.getElementById('completeStory');
      const upVote = document.getElementsByClassName('voteBtn');
        for (const vote of upVote) {
          vote.disabled = true;
        };
        const addBtn = document.getElementsByClassName('addBtn');
          for (const add of addBtn) {
            add.disabled = true;
          }
  contribution.disabled = true;
  submit.disabled = true;
  upVote.disabled = true;
  completeStory.textContent = 'Story Completed';
  completeStory.disabled = true;
});
    </script>
    <!--Upvote Script-->
    <script>
      function upVote(vote) {
        let votes = Number(document.getElementsByClassName('numOfVotes')[vote].innerText.split(' ')[0]);
        votes++;

        if (votes === 1) {
          document.getElementsByClassName('numOfVotes')[vote].innerText = votes + ' Vote';
        } else
        document.getElementsByClassName('numOfVotes')[vote].innerText = votes + ' Votes';
      }
      </script>
  </body>
</html>
